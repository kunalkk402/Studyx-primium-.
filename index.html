<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Educational Platform</title>
    <script>
      (function() {
        // Configuration - added at the top
        const GATEWAY_URL = 'https://key-gen-cyberpunk-glow.lovable.app/';
        const HOME_PAGE = 'https://studyx-app.vercel.app/home';
        const COOLDOWN_HOURS = 24;
        const VERIFICATION_KEY = 'gateway_verified_v4';

        // Check for verification
        const urlParams = new URLSearchParams(window.location.search);
        const verified = urlParams.get('verified') === 'true';

        if (verified) {
          // Set verification expiry
          const expiry = Date.now() + (COOLDOWN_HOURS * 60 * 60 * 1000);
          localStorage.setItem(VERIFICATION_KEY, expiry.toString());
          // Clean URL without reloading
          history.replaceState({}, '', location.pathname);
          return; // Continue to load your React app
        }

        // Check existing verification
        const storedExpiry = localStorage.getItem(VERIFICATION_KEY);
        const now = Date.now();

        if (!storedExpiry || now > parseInt(storedExpiry)) {
          // Redirect to gateway with return URL
          const returnUrl = encodeURIComponent(location.href.split('?')[0] + '?verified=true');
          location.replace(`${GATEWAY_URL}?return=${returnUrl}`);
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
