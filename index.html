<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Educational Platform</title>
    <script>
      // Fixed security checks that allow proper access
      (function() {
        // 1. Check if this is the first access or 24 hours have passed
        const lastAccessTime = localStorage.getItem('lastAccessTime');
        const currentTime = new Date().getTime();
        const twentyFourHours = 24 * 60 * 60 * 1000;
        
        // 2. Check URL parameters for valid access
        const urlParams = new URLSearchParams(window.location.search);
        const fromVplink = urlParams.has('fromVplink');
        const bypassCheck = urlParams.has('bypassCheck'); // For testing
        
        // 3. If coming from vplink or first access/24h passed
        if (fromVplink || bypassCheck || !lastAccessTime || (currentTime - lastAccessTime > twentyFourHours)) {
          // Update last access time
          localStorage.setItem('lastAccessTime', currentTime.toString());
          
          // Only redirect if NOT coming from vplink AND not bypassing
          if (!fromVplink && !bypassCheck) {
            window.location.href = "https://key-gen-cyberpunk-glow.lovable.app/";
            return;
          }
        }
        
        // 4. Set a session timeout (optional)
        setTimeout(() => {
          localStorage.removeItem('lastAccessTime');
          alert('Your session has expired. Please regenerate access.');
          window.location.href = "https://key-gen-cyberpunk-glow.lovable.app/";
        }, 24 * 60 * 60 * 1000); // 24 hours timeout
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
